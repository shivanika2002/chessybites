<!DOCTYPE html>
<html lang="en">
    <head>
        <title>
            Home
        </title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width,initial-scale=1.0">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Zen+Antique&display=swap" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="design.css">
    </head>
    <body>
        <div class="top">
           <ul>
            <li><a href="#">Home</a></li>
            <li><a href="#dishHeader">Dishes</a></li>
           
           </ul>
           <p id="header">ChessyBites</p>
           <p id="subheader">We are CheesyBites we are specialized to serve special mouth watering chessy things, <br>order something interesting and make your day more flavourful and joyful. <br>So why are you waiting for view our dishes and start ordering.</p><br>
            <a href="#dishHeader"><button type="button">View Dishes</button></a>
            <br><br><br><br><br><br><br><br>
        </div>
        <div class="projectSection">
            <br>
            <p id="dishHeader">Our must try <mark>Signature Dishes</mark></p>
            <br>
            <div class="aiProjects">
            <div class="project">
                <img src="meatDonor.jpg" alt="ImageFile" width="250px" height="150px">
                <div class="content">
                    <p id="MeatDonorheader" class="header">Meat Donor</p>
                    <p id="MeatDonorsubHeader" class="subHeader">Juicy meat with honey<br>overloaded with cheese and mayo.</p>
                    <div class="userInput">
                        <input type="checkbox" id="MeatDonor" value="MeatDonor">
                        <label for="MeatDonor" id="MeatDonorLabel">MeatDonor</label>
                        <input type="number" min="1" max="15" id="MeatDonorQuantity">
                    </div>
                </div>
                
            </div>
            <div class="project">
                <img src="clubSandwhich.jpg" alt="ImageFile" width="250px" height="150px">
                <div class="content">
                    <p id="ClubSandwichheader" class="header">Club Sandwich</p>
                    <p id="ClubSandwichsubHeader" class="subHeader">Meaty and juicy finger<br>licking mayo sandwich</p>
                    <div class="userInput">
                        <input type="checkbox" id="ClubSandwich" value="ClubSandwich">
                        <label for="ClubSandwich" id="ClubSandwichLabel">ClubSandwich</label>
                        <input type="number" min="1" max="15" id="ClubSandwichQuantity">  
                    </div>
                </div>
                
            </div>
            <div class="project">
                <img src="pizza.jpg" alt="ImageFile" width="250px" height="150px">
                <div class="content">
                    <p id="Pizzaheader" class="header">Pizza</p>
                    <p id="PizzasubHeader" class="subHeader">Margherita cheese filled with<br>olives and meat toppings.</p>
                    <div class="userInput">
                        <input type="checkbox" id="Pizza" value="Pizza">
                        <label for="Pizza" id="PizzaLabel">Pizza</label>
                        <input type="number" min="1" max="15" id="PizzaQuantity"> 
                    </div>
                </div>
                
            </div>
            <div class="project">
                <img src="burger.jpg" alt="ImageFile" width="250px" height="150px">
                <div class="content">
                    <p id="Burgerheader"  class="header">Burger</p>
                    <p id="BurgersubHeader" class="subHeader">Cheesy layers filled with<br>mayo, meat and veggies.</p>
                    <div class="userInput">
                        <input type="checkbox" id="Burger" value="Burger">
                        <label for="Burger" id="BurgerLabel">Burger</label>
                        <input type="number" min="1" max="15" id="BurgerQuantity">
                    </div>
                </div>
                
            </div>
            <div class="project">
                <img src="tacos.jpg" alt="ImageFile" width="250px" height="150px">
                <div class="content">
                    <p id="Tacosheader" class="header">Tacos</p>
                    <p id="TacossubHeader" class="subHeader">Yummy tacos made with<br>mexican stuffing and rolls.</p>
                    <div class="userInput">
                        <input type="checkbox" id="Tacos" value="Tacos">
                        <label for="Tacos" id="TacosLabel">Tacos</label>
                        <input type="number" min="1" max="15" id="TacosQuantity"> 
                    </div>
                </div>
                
            </div>
            <div class="project">
                <img src="briyaniNoodles.jpg" alt="ImageFile" width="250px" height="150px">
                <div class="content">
                    <p id="Briyaniheader" class="header">Briyani Noodles</p>
                    <p id="BriyanisubHeader" class="subHeader">Briyani noodles filled with<br>authentic briyani spices.</p>
                    <div class="userInput">
                        <input type="checkbox" id="Briyani" value="Briyani">
                        <label for="Briyani" id="BriyaniLabel">Briyani Noodles</label>
                        <input type=number min="1" max="15" id="BriyaniQuantity">
                    </div>
                </div>
                
            </div>
            <div class="project">
                <img src="pasta.jpg" alt="ImageFile" width="250px" height="150px">
                <div class="content">
                    <p id="Pastaheader" class="header">Pasta</p>
                    <p id="PastasubHeader" class="subHeader">Chessy and juicy pasta <br>made with mozerilla cheese.</p>
                    <div class="userInput">
                        <input type="checkbox" id="Pasta" value="Pasta">
                        <label for="Pasta" id="PastaLabel">Pasta</label>
                        <input type="number" min="1" max="15" id="PastaQuantity">
                    </div>
                </div>
                
            </div>
            <div class="project">
                <img src="grapejuice.jpg" alt="ImageFile" width="250px" height="150px">
                <div class="content">
                    <p id="GrapeJuiceheader" class="header">Grape Juice</p>
                    <p id="GrapeJuicesubHeader" class="subHeader">Fresh arabian grapejuice<br>with berry pulps and cream.</p>
                    <div class="userInput">
                        <input type="checkbox" id="GrapeJuice" value="GrapeJuice">
                        <label for="GrapeJuice" id="GrapeJuiceLabel">GrapeJuice</label>
                        <input type=number min="1" max="15" id="GrapeJuiceQuantity">
                    </div>
                </div>
                
            </div>
            <div class="project">
                <img src="pastrypic.jpg" alt="ImageFile" width="250px" height="150px">
                <div class="content">
                    <p id="Brownieheader" class="header">Brownie</p>
                    <p id="BrowniesubHeader" class="subHeader">Chocolate overfilled brownie<br>with nuts and chocochips</p>
                    <div class="userInput">
                        <input type="checkbox" id="Brownie" value="Brownie">
                        <label for="Brownie" id="BrownieLabel">Brownie</label>
                        <input type="number" min="1" max="15" id="BrownieQuantity">
                    </div>
                </div>
                
            </div>
            <div class="project">
                <img src="milkshake.jpg" alt="ImageFile" width="250px" height="150px">
                <div class="content">
                    <p id="MilkShakeheader" class="header">Milkshake</p>
                    <p id="MilkShakesubHeader" class="subHeader">Creamy and yummy milkshake<br>made with fresh milk and creams.</p>
                    <div class="userInput">
                        <input type="checkbox" id="MilkShake" value="MilkShake">
                        <label for="MilkShake" id="MilkShakeLabel">MilkShake</label>
                        <input type="number" min="1" max="15" id="MilkShakeQuantity">
                    </div>
                </div>
                
            </div>
            <div class="project">
                <img src="icecreampic.jpg" alt="ImageFile" width="250px" height="150px">
                <div class="content">
                    <p id="Icecreamheader" class="header">IceCream</p>
                    <p id="IcecreamsubHeader" class="subHeader">Fluffy and consistent <br>with exotic flavors.</p>
                    <div class="userInput">
                        <input type="checkbox" id="Icecream" value="IceCream">
                        <label for="Icecream" id="IcecreamLabel">Icecream</label>
                        <input type=number min="1" max="15" id="IceCreamQuantity">
                    </div>
                </div>
                
            </div>
            </div>
            <br>
            </div>
            <div class="servicecontainer">
                <br><br>
                <div class="servicecontainerone">
                    <p id="serviceHeader"><mark>Register</mark> with your Phone Number and get interesting <mark>Offers</mark></p>
                    <p id="serviceSubHeader"><mark>Eat well, Sleep well. </mark>Your dish will be provided within 10 minutes after you have ordred. Please wait patiently until that. You will be notified by our team if your order is prepared.</p>
                </div>
                <div class="servicecontainertwo">
                    <form name="" id="serviceForm" method="get" onsubmit="" >
                        <br>
                        <label for="tableNo">Enter Table Number</label>&nbsp;&nbsp; <input type="number" id="tableno" min="1" max="10"><br><br>
                        <label for="userName">Enter your Name</label><br>
                        <input type="text" id="userName" placeholder="Enter your Name"><br>
                        <label for="userNumber">Enter your Number</label><br>
                        <input type="tel" maxlength="10" id="userNumber" name="number" placeholder="+91 - Number"><br>
                        <h1 id="billAmount">INR 0/-</h1>
                        <button type="button" id="calcBtn">View Bill</button>
                        <button type="button" id="orderBtn">Order</button>
                    </form>
                </div>
            </div>  
        <div class="bottom">

        </div>
        <script type="module">
            let tempAmount = 0;
            let a = [];
            let dishes;
            let tableNo,quantity,totalAmount;
            let BriyaniPrice,IcecreamPrice,GrapeJuicePrice,ClubSandwichPrice,MeatDonorPrice,PizzaPrice,BrowniePrice,BurgerPrice,MilkShakePrice,TacosPrice,PastaPrice;
            function append(value){
              let pos = a.length;
              a[pos] = value;
            }
            let dishPrice = new Map([
              ['Briyani',120],
              ['GrapeJuice',80],
              ['IceCream',150],
              ['ClubSandwich',100],
              ['MeatDonor',120],
              ['Pizza',150],
              ['Brownie',130],
              ['Burger',110],
              ['MilkShake',80],
              ['Pasta',140],
              ['Tacos',70]
            ]);
      
            function checkQuantity(qty,qtyLabel){
              if(qty<1){
                quantity = 1;
                document.getElementById(qtyLabel).value=1;
              }
              if(qty>15){
                quantity = 15;
                document.getElementById(qtyLabel).value=15;
              }
            }
      
            function calcAmount(price){
                tempAmount = tempAmount+price;
            }
            function displayAmount(){
              getCart();
              let cart =dishes+"--INR"+tempAmount;
              billAmount.innerHTML = cart;
              totalAmount = tempAmount;
              tempAmount = 0;
            }
            function getCart(){
                check();
                dishes="";
                for(let i=0;i<a.length;i++){
                  dishes = dishes + a[i]+"      ";
                }
              }

            let userName = document.getElementById('userName');
            let userNumber = document.getElementById('userNumber');

            let calcBtn = document.getElementById('calcBtn');
            let billAmount = document.getElementById('billAmount');

            let Briyani = document.getElementById('Briyani');
            let Icecream = document.getElementById('Icecream');
            let GrapeJuice = document.getElementById('GrapeJuice');
            let ClubSandwich = document.getElementById('ClubSandwich');
            let MeatDonor = document.getElementById('MeatDonor');
            let Pizza = document.getElementById('Pizza');
            let Brownie = document.getElementById('Brownie');
            let Burger = document.getElementById('Burger');
            let MilkShake = document.getElementById('MilkShake');
            let Pasta = document.getElementById('Pasta');
            let Tacos = document.getElementById('Tacos');
      
            calcBtn.addEventListener('click',checkAmount);
      
            function check(){
              a= [];
              tableNo = document.getElementById('tableno').value;
              if(tableNo!="" && userName.value!="" && userNumber.value!="" && (Briyani.checked==true || Icecream.checked==true || GrapeJuice.checked==true || ClubSandwich.checked==true || MeatDonor.checked==true || Pizza.checked==true || Brownie.checked==true || Burger.checked==true || MilkShake.checked==true || Pasta.checked==true || Tacos.checked==true)){
                  if(Briyani.checked==true){
                    quantity = document.getElementById(Briyani.value+'Quantity').value;
                    checkQuantity(quantity,Briyani.value+'Quantity');
                    append(Briyani.value+"--"+quantity);
                  }
                  if(Icecream.checked==true){
                    quantity = document.getElementById(Icecream.value+'Quantity').value;
                    checkQuantity(quantity);
                    append(Icecream.value+"--"+quantity);
                   
                  }
                  if(GrapeJuice.checked==true){
                    quantity = document.getElementById(GrapeJuice.value+'Quantity').value;
                    checkQuantity(quantity);
                    append(GrapeJuice.value+"--"+quantity); 
                  }
      
                  if(ClubSandwich.checked==true){
                    quantity = document.getElementById(ClubSandwich.value+'Quantity').value;
                    checkQuantity(quantity);
                    append(ClubSandwich.value+"--"+quantity); 
                  }
      
                  if(MeatDonor.checked==true){
                    quantity = document.getElementById(MeatDonor.value+'Quantity').value;
                    checkQuantity(quantity);
                    append(MeatDonor.value+"--"+quantity); 
                  }
      
                  if(Pizza.checked==true){
                    quantity = document.getElementById(Pizza.value+'Quantity').value;
                    checkQuantity(quantity);
                    append(Pizza.value+"--"+quantity); 
                  }
      
                  if(Brownie.checked==true){
                    quantity = document.getElementById(Brownie.value+'Quantity').value;
                    checkQuantity(quantity);
                    append(Brownie.value+"--"+quantity); 
                  }
      
                  if(Burger.checked==true){
                    quantity = document.getElementById(Burger.value+'Quantity').value;
                    checkQuantity(quantity);
                    append(Burger.value+"--"+quantity); 
                  }
      
                  if(MilkShake.checked==true){
                    quantity = document.getElementById(MilkShake.value+'Quantity').value;
                    checkQuantity(quantity);
                    append(MilkShake.value+"--"+quantity); 
                  }
      
                  if(Pasta.checked==true){
                    quantity = document.getElementById(Pasta.value+'Quantity').value;
                    checkQuantity(quantity);
                    append(Pasta.value+"--"+quantity); 
                  }
      
                  if(Tacos.checked==true){
                    quantity = document.getElementById(Tacos.value+'Quantity').value;
                    checkQuantity(quantity);
                    append(Tacos.value+"--"+quantity); 
                  }
              }
              else{
                alert("Select the fields properly!");
              }  
            }
      
      
            function checkAmount(){
              tempAmount = 0
              if(Briyani.checked==true){
                let amount =  dishPrice.get(Briyani.value);
                    quantity = document.getElementById(Briyani.value+'Quantity').value;
                    checkQuantity(quantity,Briyani.value+'Quantity');
                    amount = amount * quantity;
                    
                    calcAmount(amount);
              }
              if(Icecream.checked==true){
                let amount =  dishPrice.get(Icecream.value);
                    quantity = document.getElementById(Icecream.value+'Quantity').value;
                    checkQuantity(quantity,Icecream.value+'Quantity');
                    amount = amount * quantity;
                    
                    calcAmount(amount);
              }
              if(GrapeJuice.checked==true){
                let amount =  dishPrice.get(GrapeJuice.value);
                    quantity = document.getElementById(GrapeJuice.value+'Quantity').value;
                    checkQuantity(quantity,GrapeJuice.value+'Quantity');
                    amount = amount * quantity;
                    
                    calcAmount(amount);
              }
              if(ClubSandwich.checked==true){
                let amount =  dishPrice.get(ClubSandwich.value);
                    quantity = document.getElementById(ClubSandwich.value+'Quantity').value;
                    checkQuantity(quantity,ClubSandwich.value+'Quantity');
                    amount = amount * quantity;
                    
                    calcAmount(amount);
              }
              if(MeatDonor.checked==true){
                let amount =  dishPrice.get(MeatDonor.value);
                    quantity = document.getElementById(MeatDonor.value+'Quantity').value;
                    checkQuantity(quantity,MeatDonor.value+'Quantity');
                    amount = amount * quantity;
                    
                    calcAmount(amount);
              }
              if(Pizza.checked==true){
                let amount =  dishPrice.get(Pizza.value);
                    quantity = document.getElementById(Pizza.value+'Quantity').value;
                    checkQuantity(quantity,Pizza.value+'Quantity');
                    amount = amount * quantity;
                    
                    calcAmount(amount);
              }
              if(Brownie.checked==true){
                let amount =  dishPrice.get(Brownie.value);
                    quantity = document.getElementById(Brownie.value+'Quantity').value;
                    checkQuantity(quantity,Brownie.value+'Quantity');
                    amount = amount * quantity;
                    
                    calcAmount(amount);
              }
              if(Burger.checked==true){
                let amount =  dishPrice.get(Burger.value);
                    quantity = document.getElementById(Burger.value+'Quantity').value;
                    checkQuantity(quantity,Burger.value+'Quantity');
                    amount = amount * quantity;
                    
                    calcAmount(amount);
              }
              if(MilkShake.checked==true){
                let amount =  dishPrice.get(MilkShake.value);
                    quantity = document.getElementById(MilkShake.value+'Quantity').value;
                    checkQuantity(quantity,MilkShake.value+'Quantity');
                    amount = amount * quantity;
                    
                    calcAmount(amount);
              }
              if(Pasta.checked==true){
                let amount =  dishPrice.get(Pasta.value);
                    quantity = document.getElementById(Pasta.value+'Quantity').value;
                    checkQuantity(quantity,Pasta.value+'Quantity');
                    amount = amount * quantity;
                    
                    calcAmount(amount);
              }
              if(Tacos.checked==true){
                let amount =  dishPrice.get(Tacos.value);
                    quantity = document.getElementById(Tacos.value+'Quantity').value;
                    checkQuantity(quantity,Tacos.value+'Quantity');
                    amount = amount * quantity;
                    
                    calcAmount(amount);
              }
              displayAmount();
            }
              // Import the functions you need from the SDKs you need
              import { initializeApp } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";
              import {getDatabase,set,get,update,remove,ref,child} from "https://www.gstatic.com/firebasejs/9.15.0/firebase-database.js";
              // TODO: Add SDKs for Firebase products that you want to use
              // https://firebase.google.com/docs/web/setup#available-libraries
            
              // Your web app's Firebase configuration
              // For Firebase JS SDK v7.20.0 and later, measurementId is optional
              const firebaseConfig = {
                apiKey: "AIzaSyBR2kicO-oW1aph4o76Vt9OxnRCXsuGeC8",
                authDomain: "cheesybite-3ab8c.firebaseapp.com",
                databaseURL: "https://cheesybite-3ab8c-default-rtdb.firebaseio.com",
                projectId: "cheesybite-3ab8c",
                storageBucket: "cheesybite-3ab8c.appspot.com",
                messagingSenderId: "994789801519",
                appId: "1:994789801519:web:ab691495d4db298f1910da",
                measurementId: "G-XMG22GMXJE"
              };
            
              // Initialize Firebase
              const app = initializeApp(firebaseConfig);
              const db = getDatabase();
              function insertData(){
                check();
                let name = userName.value;
                let phone = userNumber.value;
                dishes="";
                for(let i=0;i<a.length;i++){
                  dishes = dishes + a[i]+"      ";
                }
                if(dishes!=""){
                  dishes = dishes + "-----INR-"+totalAmount;
                  set(ref(db,"Table/"+tableNo),{
                    dish : name+"-"+phone+"-"+dishes
                  }).then(()=>{
                    alert('Success');
                  }).catch((error)=>{
                    alert("Failed")
                  });
                }
              }
      
              let order = document.getElementById('orderBtn');
              order.addEventListener('click',insertData);
      
              let dishitems = ['Briyani','GrapeJuice','Icecream','ClubSandwich','MeatDonor','Pizza','Brownie','Burger','MilkShake','Pasta','Tacos'];
              function checkStatus(){
                for(let j=0;j<dishitems.length;j++){
                  fetchStatus(dishitems[j]);
                  fetchPriceStatus(dishitems[j]);
                }
              }
              function fetchStatus(dishname){
                  const dbref = ref(db);
                  get(child(dbref,"Dish/"+dishname)).then((snapshot)=>{
                      if(snapshot.exists()){
                          let dishStatus = snapshot.val().Status;
                          if(dishStatus=="Yes"){
                            document.getElementById(dishname+"Label").innerText=dishname;
                            document.getElementById(dishname).style.display = "inline";
                          }
                          else{
                            document.getElementById(dishname+"Label").innerText="Not Available";
                            document.getElementById(dishname).style.display = "none";
                            document.getElementById(dishname).checked = false;
                          }
                      }else{
                          alert("No data");
                      }
                  }).catch((error)=>{
                      alert("No Connection");
                  });
                }
                function fetchPriceStatus(itemname){
                  const dbref = ref(db);
                  get(child(dbref,"Price/"+itemname)).then((snapshot)=>{
                      if(snapshot.exists()){
                          let priceStatus = snapshot.val().Price;
                          if(itemname=="Icecream"){
                            itemname = "IceCream";
                          }
                          dishPrice.set(itemname,priceStatus);
                          if(itemname=="IceCream"){
                            itemname = "Icecream";
                          }
                          document.getElementById(itemname+"header").innerText=itemname+"-INR"+priceStatus;
                          
                      }else{
                          alert("No data");
                      }
                  }).catch((error)=>{
                      alert("No Connection");
                  });
                }
                setInterval(checkStatus,1000);
            </script>
    </body>
</html>